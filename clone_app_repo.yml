---
- hosts: app_servers
  tasks:
    - name: clone repo to app_server
      git: 
       repo: https://github.com/oyedeloy/finalproject1_2020.git
       dest: /home/ec2-user/config
       update: yes
      become: true    
    

    - name: build docker image
      docker_image:
        path: /home/ec2-user/config
        name: voting
    - name: build container
      shell: docker run -d -p 80:80 -e REDIS=10.7.2.110 -e REDIS_PORT=6379 -e REDIS_PWD=admin --name voting_app voting
      
